-- CAMPOS TABLA MAESTRA ORIGINAL
	USUARIO_NOMBRE nvarchar(255) NULL,          -- USADO
	USUARIO_APELLIDO nvarchar(255) NULL,        -- USADO
	USUARIO_DNI decimal(18, 0) NULL,            -- USADO
	USUARIO_FECHA_REGISTRO datetime2(3) NULL,   -- USADO
	USUARIO_TELEFONO decimal(18, 0) NULL,       -- USADO
	USUARIO_MAIL nvarchar(255) NULL,            -- USADO
	USUARIO_FECHA_NAC date NULL,                -- USADO

	ENVIO_MENSAJERIA_NRO decimal(18, 0) NULL,                   -- USADO
	ENVIO_MENSAJERIA_DIR_ORIG nvarchar(255) NULL,               -- USADO
	ENVIO_MENSAJERIA_DIR_DEST nvarchar(255) NULL,               -- USADO
	ENVIO_MENSAJERIA_LOCALIDAD nvarchar(255) NULL,              -- USADO
	ENVIO_MENSAJERIA_PROVINCIA nvarchar(255) NULL,              -- USADO
	ENVIO_MENSAJERIA_KM decimal(18, 2) NULL,                    -- USADO
	ENVIO_MENSAJERIA_VALOR_ASEGURADO decimal(18, 2) NULL,       -- USADO
	ENVIO_MENSAJERIA_PRECIO_ENVIO decimal(18, 2) NULL,          -- USADO
	ENVIO_MENSAJERIA_PRECIO_SEGURO decimal(18, 2) NULL,         -- USADO
	ENVIO_MENSAJERIA_PROPINA decimal(18, 2) NULL,               -- USADO
	ENVIO_MENSAJERIA_TOTAL decimal(18, 2) NULL,                 -- USADO
	ENVIO_MENSAJERIA_OBSERV nvarchar(255) NULL,                 -- USADO
	ENVIO_MENSAJERIA_FECHA datetime NULL,                       -- USADO
	ENVIO_MENSAJERIA_FECHA_ENTREGA datetime NULL,               -- USADO
	ENVIO_MENSAJERIA_TIEMPO_ESTIMADO decimal(18, 2) NULL,       -- USADO
	ENVIO_MENSAJERIA_CALIFICACION decimal(18, 0) NULL,          -- USADO
	ENVIO_MENSAJERIA_ESTADO nvarchar(50) NULL,                  -- USADO

	REPARTIDOR_NOMBRE nvarchar(255) NULL,           -- USADO
	REPARTIDOR_APELLIDO nvarchar(255) NULL,         -- USADO
	REPARTIDOR_DNI decimal(18, 0) NULL,             -- USADO
	REPARTIDOR_TELEFONO decimal(18, 0) NULL,        -- USADO
	REPARTIDOR_DIRECION nvarchar(255) NULL,         -- USADO
	REPARTIDOR_EMAIL nvarchar(255) NULL,            -- USADO
	REPARTIDOR_FECHA_NAC date NULL,                 -- USADO
	REPARTIDOR_TIPO_MOVILIDAD nvarchar(50) NULL,    -- USADO

	PAQUETE_TIPO nvarchar(50) NULL,             -- USADO
	PAQUETE_ALTO_MAX decimal(18, 2) NULL,       -- USADO
	PAQUETE_ANCHO_MAX decimal(18, 2) NULL,      -- USADO
	PAQUETE_LARGO_MAX decimal(18, 2) NULL,      -- USADO
	PAQUETE_PESO_MAX decimal(18, 2) NULL,       -- USADO
	PAQUETE_TIPO_PRECIO decimal(18, 2) NULL,    -- USADO


	MEDIO_PAGO_NRO_TARJETA nvarchar(50) NULL,       -- USADO
	MEDIO_PAGO_TIPO nvarchar(50) NULL,              -- USADO
	MARCA_TARJETA nvarchar(100) NULL,				-- USADO

	PEDIDO_NRO decimal(18, 0) NULL,                         -- USADO
	PEDIDO_TOTAL_PRODUCTOS decimal(18, 2) NULL,             -- ESTE CAMPO SERIA EL ITEM_TOTAL?
	PEDIDO_PRECIO_ENVIO decimal(18, 2) NULL,                -- USADO
	PEDIDO_TARIFA_SERVICIO decimal(18, 2) NULL,             -- USADO
	PEDIDO_PROPINA decimal(18, 2) NULL,                     -- USADO
	PEDIDO_TOTAL_CUPONES decimal(18, 2) NULL,               -- USADO
	PEDIDO_TOTAL_SERVICIO decimal(18, 2) NULL,              -- USADO
	PEDIDO_OBSERV nvarchar(255) NULL,                       -- USADO
	PEDIDO_FECHA datetime NULL,                             -- USADO
	PEDIDO_FECHA_ENTREGA datetime NULL,                     -- USADO
	PEDIDO_TIEMPO_ESTIMADO_ENTREGA decimal(18, 2) NULL,     -- USADO
	PEDIDO_CALIFICACION decimal(18, 0) NULL,                -- USADO
    PEDIDO_ESTADO nvarchar(50) NULL,                        -- USADO

	DIRECCION_USUARIO_NOMBRE nvarchar(50) NULL,             -- USADO
	DIRECCION_USUARIO_DIRECCION nvarchar(255) NULL,         -- USADO
	DIRECCION_USUARIO_LOCALIDAD nvarchar(255) NULL,         -- USADO
	DIRECCION_USUARIO_PROVINCIA nvarchar(255) NULL,         -- USADO

	LOCAL_NOMBRE nvarchar(100) NULL,				-- USADO
	LOCAL_DESCRIPCION nvarchar(255) NULL,			-- USADO
	LOCAL_DIRECCION nvarchar(255) NULL,				-- USADO
	LOCAL_TIPO nvarchar(50) NULL,					-- USADO
	LOCAL_LOCALIDAD nvarchar(255) NULL,				-- USADO
	LOCAL_PROVINCIA nvarchar(255) NULL,				-- USADO

	HORARIO_LOCAL_HORA_APERTURA decimal(18, 0) NULL, 	-- USADO	
	HORARIO_LOCAL_HORA_CIERRE decimal(18, 0) NULL, 		-- USADO
	HORARIO_LOCAL_DIA nvarchar(50) NULL, 				-- USADO

	PRODUCTO_LOCAL_CODIGO nvarchar(50) NULL,		-- USADO
	PRODUCTO_LOCAL_NOMBRE nvarchar(50) NULL,		-- USADO
	PRODUCTO_LOCAL_DESCRIPCION nvarchar(255) NULL,	-- USADO
	PRODUCTO_LOCAL_PRECIO decimal(18, 2) NULL,		-- USADO ITEM_PRECIO
	PRODUCTO_CANTIDAD decimal(18, 0) NULL,			-- USADO ITEM_CANTIDAD

	CUPON_NRO decimal(18, 0) NULL,					-- USADO
	CUPON_MONTO decimal(18, 2) NULL,				-- USADO
	CUPON_FECHA_ALTA datetime NULL,					-- USADO
	CUPON_FECHA_VENCIMIENTO datetime NULL,			-- USADO
	CUPON_TIPO nvarchar(50) NULL,					-- USADO

	CUPON_RECLAMO_NRO decimal(18, 0) NULL,			-- USADO
	CUPON_RECLAMO_MONTO decimal(18, 2) NULL,        -- USADO
	CUPON_RECLAMO_FECHA_ALTA datetime NULL,         -- USADO
	CUPON_RECLAMO_FECHA_VENCIMIENTO datetime NULL,  -- USADO
	CUPON_RECLAMO_TIPO nvarchar(50) NULL            -- USADO

    RECLAMO_NRO decimal(18, 0) NULL,            -- USADO
	RECLAMO_FECHA datetime NULL,                -- USADO
	RECLAMO_DESCRIPCION nvarchar(255) NULL,     -- USADO
	RECLAMO_FECHA_SOLUCION datetime NULL,       -- USADO
	RECLAMO_SOLUCION nvarchar(255) NULL,        -- USADO
	RECLAMO_CALIFICACION decimal(18, 0) NULL,   -- USADO
	RECLAMO_TIPO nvarchar(50) NULL,             -- USADO
	RECLAMO_ESTADO nvarchar(50) NULL,           -- USADO

	OPERADOR_RECLAMO_NOMBRE nvarchar(255) NULL,		-- USADO
	OPERADOR_RECLAMO_APELLIDO nvarchar(255) NULL,	-- USADO
	OPERADOR_RECLAMO_DNI decimal(18, 0) NULL,		-- USADO
	OPERADOR_RECLAMO_TELEFONO decimal(18, 0) NULL,	-- USADO
	OPERADOR_RECLAMO_DIRECCION nvarchar(255) NULL,	-- USADO
	OPERADOR_RECLAMO_MAIL nvarchar(255) NULL,		-- USADO
	OPERADOR_RECLAMO_FECHA_NAC date NULL,			-- USADO

-- MIGRACIONES
	USUARIO				-- MIGRADO	REVISAR
	PROVINCIA 			-- MIGRADO	REVISAR
	LOCALIDAD 			-- MIGRADO	REVISAR
	REPARTIDOR			-- MIGRADO 	REVISAR
	DIRECCION_USUARIO  	-- MIGRADO  REVISAR
	LOCAL				-- MIGRADO  REVISAR		LAS DIRECCIONES NO SE REPITEN CON DIRECC USUARIO? HABRIA Q INTENTAR NORMALIAR ESO?
	TIPO_LOCAL			-- MIGRADO  REVISAR
	ALTA				-- COMO LO DEFINIMOS?
	CATEGORIA 			-- MIGRADO	NO HAY REGISTROS
	DIA 				-- MIGRADO  REVISAR
	HORARIO				-- MIGRADO  REVISAR
	PRODUCTO			-- MIGRADO 	REVISAR
	LOCAL_PRODUCTO		-- MIGRADO 	REVISAR
	ITEM				
	ENVIO_MENSAJERIA	
	PAQUETE
	MEDIO_PAGO	
	PEDIDO      
	CUPON
	CUPON_RECLAMO
	RECLAMO
	OEPERADOR

-- BLOQUES BASICOS PARA MIGRACION

BEGIN
	INSERT INTO NEW_MODEL.PEDIDO_ENVIO(PEDIDO_ENVIO_PRECIO, PEDIDO_ENVIO_TARIFA_SERVICIO,PEDIDO_ENVIO_PROPINA)
	SELECT DISTINCT PEDIDO_PRECIO_ENVIO,PEDIDO_TARIFA_SERVICIO,PEDIDO_PROPINA FROM gd_esquema.Maestra
	WHERE PEDIDO_PRECIO_ENVIO IS NOT NULL
END
GO

CREATE PROCEDURE MIGRAR_PEDIDO_ESTADO AS
BEGIN
	
	INSERT INTO NEW_MODEL.PEDIDO_ESTADO(PEDIDO_ESTADO)
	SELECT DISTINCT PEDIDO_ESTADO FROM gd_esquema.Maestra
	WHERE PEDIDO_ESTADO IS NOT NULL
END
GO




CREATE PROCEDURE MIGRAR_MEDIO_PAGO_TIPO AS
BEGIN
	
	INSERT INTO NEW_MODEL.MEDIO_PAGO_TIPO(MEDIO_PAGO_TIPO)
	SELECT DISTINCT MEDIO_PAGO_TIPO FROM gd_esquema.Maestra
	WHERE MEDIO_PAGO_TIPO IS NOT NULL
END
GO

CREATE PROCEDURE .MIGRAR_MEDIO_PAGO AS
BEGIN
	INSERT INTO NEW_MODEL.(MEDIO_PAGO_NRO_TARJETA,MEDIO_PAGO_MARCA_TARJETA)
	SELECT DISTINCT MEDIO_PAGO_NRO_TARJETA, MARCA_TARJETA FROM gd_esquema.Maestra
	WHERE MEDIO_PAGO_NRO_TARJETA IS NOT NULL
END
GO

CREATE PROCEDURE MIGRAR_PEDIDO AS
BEGIN
	INSERT INTO NEW_MODEL.PEDIDO(PEDIDO_NRO, PEDIDO_TOTAL_CUPONES ,PEDIDO_OBSERV ,PEDIDO_FECHA ,PEDIDO_FECHA_ENTREGA ,PEDIDO_TIEMPO_ESTIMADO_ENTREGA ,PEDIDO_CALIFICACION ,PEDIDO_TOTAL_SERVICIO ,PEDIDO_TOTAL_PRODUCTO)
		SELECT DISTINCT PEDIDO_NRO,PEDIDO_TOTAL_CUPONES,PEDIDO_OBSERV,PEDIDO_FECHA,PEDIDO_FECHA_ENTREGA,PEDIDO_TIEMPO_ESTIMADO_ENTREGA,PEDIDO,PEDIDO_TOTAL_SERVICIO,PEDIDO_TOTAL_PRODUCTOS  FROM gd_esquema.Maestra
		WHERE PEDIDO_NRO IS NOT NULL
END
GO

CREATE PROCEDURE MIGRAR_TIPO_LOCAL AS
BEGIN
	INSERT INTO NEW_MODEL.TIPO_LOCAL(LOCAL_TIPO)
	SELECT DISTINCT LOCAL_TIPO FROM gd_esquema.Maestra
	WHERE LOCAL_TIPO IS NOT NULL
END
GO

--CATEGORIA--


CREATE PROCEDURE MIGRAR_LOCAL AS
BEGIN
	
	INSERT INTO NEW_MODEL.LOCAL(LOCAL_DESCRIPCIO, LOCAL_DIRECCION, LOCAL_NOMBRE)
	SELECT DISTINCT LOCAL_DESCRIPCION, LOCAL_DIRECCION,LOCAL_NOMBRE FROM gd_esquema.Maestra
	WHERE LOCAL_DIRECCION IS NOT NULL
END
GO

CREATE PROCEDURE .MIGRAR_DIA AS
BEGIN
	
	INSERT INTO NEW_MODEL.DIA(HORARIO_LOCAL_DIA)
	SELECT DISTINCT HORARIO_LOCAL_DIA FROM gd_esquema.Maestra
	WHERE HORARIO_LOCAL_DIA IS NOT NULL
END
GO




CREATE PROCEDURE MIGRAR_HORARIO AS
BEGIN
	INSERT INTO NEW_MODEL.(HORARIO_APERTURA,HORARIO_CIERRE)
	SELECT DISTINCT HORARIO_LOCAL_HORA_APERTURA,HORARIO_LOCAL_HORA_CIERRE FROM gd_esquema.Maestra
	WHERE HORARIO_LOCAL_HORA_APERTURA IS NOT NULL
END
GO


CREATE PROCEDURE MIGRAR_PRODUCTO AS
BEGIN
	INSERT INTO NEW_MODEL.PRODCUTO(PRODUCTO_CODIGO,PRODUCTO_NOMBRE,PRODUCTO_DESCRIPCION)
	SELECT DISTINCT PRODUCTO_LOCAL_CODIGO PRODUCTO_LOCAL_NOMBRE, PRODUCTO_LOCAL_DESCRIPCION FROM gd_esquema.Maestra
	WHERE PRODUCTO_LOCAL_CODIGO IS NOT NULL
END
GO


--LOCAL PRODUCTO--



CREATE PROCEDURE MIGRAR_ITEM AS
BEGIN
	
	INSERT INTO NEW_MODEL.NEW_MODEL.ITEM(ITEM_CANTIDAD,ITEM_PRECIO)
		SELECT DISTINCT PRODUCTO_CANTIDAD,PRODUCTO_LOCAL_PRECIO FROM gd_esquema.Maestra
		--WHERE ?? IS NOT NULL
	
END
GO




CREATE PROCEDURE MIGRAR_TIPO_RECLAMO AS
BEGIN
	SET IDENTITY_INSERT NEW_MODEL.TIPO_RECLAMO ON
	INSERT INTO NEW_MODEL.NEW_MODEL.(TIPO_RECLAMO_NOMBRE)
	SELECT DISTINCT RECLAMO_TIPO FROM gd_esquema.Maestra
	WHERE RECLAMO_TIPO IS NOT NULL
END
GO



CREATE PROCEDURE MIGRAR_ESTADO_RECLAMO AS
BEGIN
	SET IDENTITY_INSERT NEW_MODEL.ESTADO_RECLAMO ON
	INSERT INTO NEW_MODEL.NEW_MODEL.(ESTADO_RECLAMO_NOMBRE)
	SELECT DISTINCT RECLAMO_ESTADO FROM gd_esquema.Maestra
	WHERE RECLAMO_ESTADO IS NOT NULL
END
GO


CREATE PROCEDURE MIGRAR_OPERADOR AS
BEGIN
	INSERT INTO NEW_MODEL.(OPERADOR_RECLAMO_NOMBRE ,OPERADOR_RECLAMO_APELLIDO ,OPERADOR_RECLAMO_DNI_NRO ,OPERADOR_RECLAMO_TELEFONO ,OPERADOR_RECLAMO_DIRECCION ,OPERADOR_RECLAMO_MAIL ,OPERADOR_RECLAMO_FECHA_NAC)
	SELECT DISTINCT OPERADOR_RECLAMO_NOMBRE ,OPERADOR_RECLAMO_APELLIDO ,OPERADOR_RECLAMO_DNI ,OPERADOR_RECLAMO_TELEFONO ,OPERADOR_RECLAMO_DIRECCION ,OPERADOR_RECLAMO_MAIL ,OPERADOR_RECLAMO_FECHA_NAC FROM gd_esquema.Maestra
	WHERE OPERADOR_RECLAMO_DNI IS NOT NULL
END
GO

CREATE PROCEDURE MIGRAR_RECLAMO AS
BEGIN
	INSERT INTO NEW_MODEL.NEW_MODEL.RECLAMO(RECLAMO_NRO,RECLAMO_FECHA,RECLAMO_DESCRIPCION,RECLAMO_FECHA_SOLUCION ,RECLAMO_SOLUCION,RECLAMO_CALIFICACION)
	SELECT DISTINCT RECLAMO_NRO,RECLAMO_FECHA,RECLAMO_DESCRIPCION,RECLAMO_FECHA_SOLUCION ,RECLAMO_SOLUCION,RECLAMO_CALIFICACION  FROM gd_esquema.Maestra
	WHERE RECLAMO_NRO IS NOT NULL
END
GO

CREATE PROCEDURE MIGRAR_CUPON_TIPO AS
BEGIN
	
	INSERT INTO NEW_MODEL.NEW_MODEL.CUPON_TIPO()
	SELECT DISTINCT FROM gd_esquema.Maestra
	WHERE  IS NOT NULL
END
GO

CREATE PROCEDURE MIGRAR_CUPON AS
BEGIN
	
	INSERT INTO NEW_MODEL.CUPON(CUPON_NRO,CUPON_MONTO,CUPON_FECHA_ALTA,CUPON_FECHA_VENCIMIENTO	)
	SELECT DISTINCT CUPON_NRO,CUPON_MONTO,CUPON_FECHA_ALTA,CUPON_FECHA_VENCIMIENTO	 FROM gd_esquema.Maestra
	WHERE CUPON_NRO IS NOT NULL
END
GO

CREATE PROCEDURE MIGRAR_TIPO_PAQUETE AS
BEGIN
	
	INSERT INTO NEW_MODEL.TIPO_PAQUETE(TIPO_PAQUETE_NOMBRE,PAQUETE_ALTO_MAX,PAQUETE_ANCHO_MAX,PAQUETE_LARGO_MAX,PAQUETE_PESO_MAX)
	SELECT DISTINCT PAQUETE_TIPO,PAQUETE_ALTO_MAX,PAQUETE_ANCHO_MAX,PAQUETE_LARGO_MAX,PAQUETE_PESO_MAX FROM gd_esquema.Maestra
	WHERE PAQUETE_TIPO IS NOT NULL
END
GO

CREATE PROCEDURE MIGRAR_PAQUETE AS
BEGIN
	
	INSERT INTO NEW_MODEL.PAQUETE(TIPO_PAQUETE_PRECIO)
	SELECT DISTINCT PAQUETE_TIPO_PRECIO FROM gd_esquema.Maestra
	WHERE PAQUETE_TIPO_PRECIO IS NOT NULL
END
GO

CREATE PROCEDURE MIGRAR_MENSAJERIA_ESTADO AS
BEGIN
	
	INSERT INTO NEW_MODEL.MENSAJERIA_ESTADO(MENSAJERIA_ESTADO)
	SELECT DISTINCT ENVIO_MENSAJERIA_ESTADO FROM gd_esquema.Maestra
	WHERE ENVIO_MENSAJERIA_ESTADO IS NOT NULL
END
GO

CREATE PROCEDURE MIGRAR_ENVIO_MENSAJERIA AS
BEGIN
	
	INSERT INTO NEW_MODEL.ENVIO_MENSAJERIA(ENVIO_MENSAJERIA_DIR_ORIGEN,ENVIO_MENSAJERIA_DIR_DEST,MENSAJERIA_TIEMPO_ESTIMADO,ENVIO_MENSAJERIA_KM,ENVIO_MENSAJERIA_PRECIO_ENVIO,ENVIO_MENSAJERIA_PROPINA)
	SELECT DISTINCT ENVIO_MENSAJERIA_DIR_ORIG,ENVIO_MENSAJERIA_DIR_DEST, ENVIO_MENSAJERIA_TIEMPO_ESTIMADO, ENVIO_MENSAJERIA_KM, ENVIO_MENSAJERIA_PRECIO_ENVIO, ENVIO_MENSAJERIA_PROPINA FROM gd_esquema.Maestra
	WHERE ENVIO_MENSAJERIA_TIEMPO_ESTIMADO IS NOT NULL
END
GO

CREATE PROCEDURE MIGRAR_MENSAJERIA AS
BEGIN
	
	INSERT INTO NEW_MODEL.MENSAJERIA(MENSAJERIA_TOTAL,MENSAJERIA_OBSERV,MENSAJERIA_FECHA ,MENSAJERIA_FECHA_ENTREGA ,MENSAJERIA_VALOR_ASEGURADO ,MENSAJERIA_CALIFICACION,MENSAJERIA_PRECIO_SEGURO)
	SELECT DISTINCT ENVIO_MENSAJERIA_TOTAL,ENVIO_MENSAJERIA_OBSERV,ENVIO_MENSAJERIA_FECHA ,ENVIO_MENSAJERIA_FECHA_ENTREGA ,ENVIO_MENSAJERIA_VALOR_ASEGURADO ,ENVIO_MENSAJERIA_CALIFICACION,ENVIO_MENSAJERIA_PRECIO_SEGURO , 
 FROM gd_esquema.Maestra
	WHERE  IS NOT NULL
END
GO

-- OPTIMIZACION PROCEDURES
1) No es necesario ningun UNION en MIGRAR_PROVINCIAS
2) Solo es necesario UNION de local - envio_mensajeria en MIGRAR_LOCALIDADES
3)
 